<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Preamble · GPKernels</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../../assets/documenter.js"></script><script src="../../../../siteinfo.js"></script><script src="../../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">GPKernels</span></div><form class="docs-search" action="../../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../../">Home</a></li><li><span class="tocitem">Notebooks</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox" checked/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">KIC1430163</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Preamble</a></li><li><a class="tocitem" href="../EQP/EQP/">EQP</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Notebooks</a></li><li><a class="is-disabled">KIC1430163</a></li><li class="is-active"><a href>Preamble</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Preamble</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p>Let&#39;s add a couple of packages. If you try this out, know that they take up a pretty decent amount of memory.</p><pre><code class="language-julia">using LombScargle # Computing Lomb-Scargle periodogram, duh
using Optim # Optimization of functions
using PyCall # Package to call Python functions from the Julia language
using PyPlot # Plotting for Julia based on `matplotlib.pyplot`
using Statistics # Basic statistics functionality
using Stheno # Probabilistic programming with Gaussian processes
using Zygote # Automatic calculation of gradients</code></pre><p>Now let&#39;s get the data from the <a href="https://archive.stsci.edu/kepler/data_search/search.php">Kepler Archive</a>. To make it easier, let&#39;s use the Python&#39;s <a href="https://github.com/dfm/kplr"><code>kplr</code></a> package:</p><pre><code class="language-julia">kplr = pyimport(&quot;kplr&quot;)

# The ID of a star from the Kepler Input Catalog
KIC_ID = 1430163

# Attach the `kplr` API
client = kplr.API()

# Get the data
star = client.star(KIC_ID)

# Time values
tₐ = Vector{Float64}()

# Pre-search Data Conditioning Simple Aperture Photometry (PDCSAP) flux values
fₐ = Vector{Float32}()

# The 1-sigma errors in PDC flux values
fσₐ = Vector{Float32}()

# Get the long cadence data of the light curves
for lc in star.get_light_curves(short_cadence = false)

    # Read the data from a light curve
    data = lc.read()
    
    t₀ = get(data, &quot;TIME&quot;)
    f₀ = get(data, &quot;PDCSAP_FLUX&quot;)
    fσ₀ = get(data, &quot;PDCSAP_FLUX_ERR&quot;)

    # Create a mask for only qualitative data points
    mask = (get(data, &quot;SAP_QUALITY&quot;) .== 0) .&amp; isfinite.(t₀) .&amp; isfinite.(f₀)
    
    append!(tₐ, t₀[mask])
    append!(fₐ, f₀[mask])
    append!(fσₐ, fσ₀[mask])

end</code></pre><p>It&#39;s useful to look at this data, but before that let&#39;s make the plots a little prettier. It&#39;s never harmful.</p><pre><code class="language-julia"># Get access to rcParams
rcP = PyPlot.PyDict(PyPlot.matplotlib.&quot;rcParams&quot;)

# Set DPI
rcP[&quot;figure.dpi&quot;] = 300

# Activate TeX support
rcP[&quot;text.usetex&quot;] = true

# Activate languages support
rcP[&quot;text.latex.preamble&quot;] = raw&quot;\usepackage[main=english]{babel}&quot;

# Switch to Computer Modern font set
rcP[&quot;mathtext.fontset&quot;] = &quot;cm&quot;

# Set font sizes
rcP[&quot;font.size&quot;] = 18
rcP[&quot;legend.fontsize&quot;] = 12;

# Set the primary color
color = &quot;#425378&quot;;</code></pre><p>Okay, now all the power of TeX is under our control. Let&#39;s make that plot then:</p><pre><code class="language-julia">plot(tₐ, fₐ, color)

xlabel(L&quot;\textrm{Time, days}&quot;)
ylabel(L&quot;\textrm{Flux}&quot;)
title(latexstring(&quot;\\textrm{Time Series of KIC $KIC_ID}&quot;));</code></pre><p><img src="../KIC1430163_files/KIC1430163_3_0.png" alt="png"/></p><p>These sharp leaps are associated with the inconsistency of observational periods. Let&#39;s pick one of the quarters:</p><pre><code class="language-julia"># Create a mask to select one of successive periods of observation
mask = (tₐ .≥ 443.5105) .&amp; (tₐ .≤ 537.5502295)

# Use the mask
tₘ = tₐ[mask]
const t = tₘ .- mean(tₘ)
const f = fₐ[mask]
const fσ = fσₐ[mask]

# An auxiliary variable for the general shift of text output to the right
pad = 30

println(rpad(&quot;General info:&quot;, pad))
println(rpad(&quot;Size of the subset:&quot;, pad), size(t, 1))

const μ₀ = mean(f)
println(rpad(&quot;Mean of the flux: &quot;, pad), μ₀)

const σ²₀ = var(f)
println(rpad(&quot;Variance of the subset: &quot;, pad), σ²₀)

# Calculating the mean of the time differences between observations
Δt = []
for i in range(2, size(t, 1), step = 1)
    push!(Δt, t[i] - t[i-1])
end
Δμ = sum(Δt) / size(Δt, 1)

println(rpad(&quot;Mean of the time differences:&quot;, pad), Δμ)</code></pre><pre><code class="language-text">
    General info:                 
    Size of the subset:           3518
    Mean of the flux:             2.125678e6
    Variance of the subset:       209401.3
    Mean of the time differences: 0.026616617260856176

</code></pre><p>That will be enough. Let&#39;s look at the time series:</p><pre><code class="language-julia">close()
plot(t, f, color)

xlabel(L&quot;\textrm{Time, days}&quot;)
ylabel(L&quot;\textrm{Flux}&quot;)
title(L&quot;\textrm{Time Series of the 5th Quarter}&quot;);</code></pre><p><img src="../KIC1430163_files/KIC1430163_5_0.png" alt="png"/></p><p>Gaussian processes are cool, of course, but the models they will use will require initial values. Some of these have already been identified before (mean and variance), but we will also need an estimate of the period. Let&#39;s go the classic way and make this estimate by determining the peak position on the Lomb-Scargle periodogram.</p><pre><code class="language-julia"># Choose a set of frequencies
frequencies = range(1 / size(t, 1) + 0.0003, 1.0; length = 5000)

# Pre-plan the Lomb–Scargle periodogram
plan = LombScargle.plan(t, f, fσ; frequencies)

# Compute the Lomb–Scargle periodogram
p = lombscargle(plan)

# Get the frequency and the power vectors
ν, P = freqpower(p)

# Determine the peak
νₘ = findmaxfreq(p)[1]

# Determine the period at this peak
P₀ = 1 / νₘ

close()
plot(ν, P; color)

title(L&quot;\textrm{Lomb-Scargle Periodogram}&quot;)
xlabel(L&quot;\textrm{Frequency, days}^{-1}&quot;)
ylabel(L&quot;\textrm{Power}&quot;)

println(&quot;&quot;&quot;
Lomb–Scargle periodogram:
The peak is at $(νₘ).
The relevant estimate of the period is $(P₀).&quot;&quot;&quot;)</code></pre><p><img src="../KIC1430163_files/KIC1430163_6_0.png" alt="png"/></p><pre><code class="language-text">
    Lomb–Scargle periodogram:
    The peak is at 0.2222990081813975.
    The relevant estimate of the period is 4.498445621421726.

</code></pre><p>Here&#39;s another look at it, just with a logarithmic scale:</p><pre><code class="language-julia">close()
plot(ν, P; color)

title(L&quot;\textrm{Lomb-Scargle Periodogram}&quot;)
xlabel(L&quot;\textrm{Frequency (log scale), days}^{-1}&quot;)
ylabel(L&quot;\textrm{Power}&quot;)
xscale(&quot;log&quot;)</code></pre><p><img src="../KIC1430163_files/KIC1430163_7_0.png" alt="png"/></p><p>Yeah, close the plot. It&#39;s just good practice. This ends the preamble to this object, and we can now proceed with tests of different models for Gaussian processes. Click on any of the model IDs in the sidebar to continue.</p><pre><code class="language-julia">close()</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../../">« Home</a><a class="docs-footer-nextpage" href="../EQP/EQP/">EQP »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 31 August 2020 15:56">Monday 31 August 2020</span>. Using Julia version 1.5.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
